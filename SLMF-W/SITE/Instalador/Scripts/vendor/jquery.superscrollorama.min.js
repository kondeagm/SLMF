!function(t){t.superscrollorama=function(e){function s(){g.scroll(function(){v=!0}),TweenLite.ticker.addEventListener("tick",n)}function i(t){var e={top:parseFloat(t.css("top")),left:parseFloat(t.css("left"))};return isNaN(e.top)&&(e.top=0),isNaN(e.left)&&(e.left=0),e}function n(){v&&(a(),v=!1)}function o(t){t.el.css("position",t.origPositioning.pos),t.el.css("top",t.origPositioning.top),t.el.css("left",t.origPositioning.left)}function r(t,e){t&&(t.totalProgress?t.totalProgress(e).pause():t.progress(e).pause())}function a(){var e,s,n,a=l.settings.isVertical?g.scrollTop()+h.y:g.scrollLeft()+h.x,p=l.settings.triggerAtCenter?l.settings.isVertical?-g.height()/2:-g.width()/2:0,c=u.length;for(e=0;c>e;e++){var v=u[e],P=v.target,w=v.offset;if("string"==typeof P?(f=t(P).offset(),s=l.settings.isVertical?f.top+h.y:f.left+h.x,w+=p):"number"==typeof P?s=P:t.isFunction(P)?s=P.call(this):(f=P.offset(),s=l.settings.isVertical?f.top+h.y:f.left+h.x,w+=p),s+=w,n=s+v.dur,a>s&&n>a&&"TWEENING"!==v.state&&(v.state="TWEENING",v.start=s,v.end=n),s>a&&"BEFORE"!==v.state&&v.reverse)l.settings.playoutAnimations||0===v.dur?v.tween.reverse():r(v.tween,0),v.state="BEFORE";else if(a>n&&"AFTER"!==v.state)l.settings.playoutAnimations||0===v.dur?v.tween.play():r(v.tween,1),v.state="AFTER";else if("TWEENING"===v.state){var E=!1;if(v.tween.repeat&&(E=-1===v.tween.repeat()),E){var m=v.tween.totalProgress();(null===v.playeadLastPosition||m===v.playeadLastPosition)&&(1===m?v.tween.yoyo()?v.tween.reverse():v.tween.totalProgress(0).play():v.tween.play()),v.playeadLastPosition=m}else r(v.tween,(a-v.start)/(v.end-v.start))}}var y=d.length;for(e=0;y>e;e++){var F=d[e],N=F.el;if("PINNED"!==F.state){"UPDATE"===F.state&&o(F),s=l.settings.isVertical?F.spacer.offset().top+h.y:F.spacer.offset().left+h.x,s+=F.offset,n=s+F.dur;var T=a>n&&"BEFORE"===F.state||s>a&&"AFTER"===F.state,x=a>s&&n>a;(x||T)&&(F.pushFollowers&&"static"===N.css("position")&&N.css("position","relative"),F.origPositioning={pos:N.css("position"),top:F.spacer.css("top"),left:F.spacer.css("left")},F.fixedPositioning={top:l.settings.isVertical?-F.offset:F.spacer.offset().top,left:l.settings.isVertical?F.spacer.offset().left:-F.offset},N.css("position","fixed"),N.css("top",F.fixedPositioning.top),N.css("left",F.fixedPositioning.left),F.pinStart=s,F.pinEnd=n,F.pushFollowers?l.settings.isVertical?F.spacer.height(F.dur+N.outerHeight()):F.spacer.width(F.dur+N.outerWidth()):"absolute"===F.origPositioning.pos?(F.spacer.width(0),F.spacer.height(0)):l.settings.isVertical?F.spacer.height(N.outerHeight()):F.spacer.width(N.outerWidth()),"UPDATE"===F.state?F.anim&&r(F.anim,0):F.onPin&&F.onPin("AFTER"===F.state),F.state="PINNED")}if("PINNED"===F.state)if(a<F.pinStart||a>F.pinEnd){var A=a<F.pinStart;F.state=A?"BEFORE":"AFTER",r(F.anim,A?0:1);var V=A?0:F.dur;l.settings.isVertical?F.spacer.height(F.pushFollowers?V:0):F.spacer.width(F.pushFollowers?V:0);var R=F.fixedPositioning.top-i(F.el).top,U=F.fixedPositioning.left-i(F.el).left;if(o(F),!F.pushFollowers||"absolute"===F.origPositioning.pos){var D;"relative"===F.origPositioning.pos?(D=l.settings.isVertical?parseFloat(F.origPositioning.top):parseFloat(F.origPositioning.left),isNaN(D)&&(D=0)):D=l.settings.isVertical?F.spacer.position().top:F.spacer.position().left;var I=l.settings.isVertical?"top":"left";F.el.css(I,D+V)}0!==R&&F.el.css("top",i(F.el).top-R),0!==U&&F.el.css("left",i(F.el).left-U),F.onUnpin&&F.onUnpin(!A)}else F.anim&&r(F.anim,(a-F.pinStart)/(F.pinEnd-F.pinStart))}}var l=this,p={isVertical:!0,triggerAtCenter:!0,playoutAnimations:!0,reverse:!0};l.settings=t.extend({},p,e);var f,c,g=t(window),u=[],d=[],h={x:0,y:0},v=!1;return l.addTween=function(t,e,s,i,n){return e.pause(),u.push({target:t,tween:e,offset:i||0,dur:s||0,reverse:"undefined"!=typeof n?n:l.settings.reverse,state:"BEFORE"}),l},l.pin=function(e,s,i){"string"==typeof e&&(e=t(e));var n={offset:0,pushFollowers:!0};i=t.extend({},n,i),i.anim&&i.anim.pause();var o=t('<div class="superscrollorama-pin-spacer"></div>');return o.css("position","relative"),o.css("top",e.css("top")),o.css("left",e.css("left")),e.before(o),d.push({el:e,state:"BEFORE",dur:s,offset:i.offset,anim:i.anim,pushFollowers:i.pushFollowers,spacer:o,onPin:i.onPin,onUnpin:i.onUnpin}),l},l.updatePin=function(e,s,i){"string"==typeof e&&(e=t(e)),i.anim&&i.anim.pause();var n=d.length;for(c=0;n>c;c++){var o=d[c];e.get(0)===o.el.get(0)&&(s&&(o.dur=s),i.anim&&(o.anim=i.anim),i.offset&&(o.offset=i.offset),"undefined"!=typeof i.pushFollowers&&(o.pushFollowers=i.pushFollowers),i.onPin&&(o.onPin=i.onPin),i.onUnpin&&(o.onUnpin=i.onUnpin),(s||i.anim||i.offset)&&"PINNED"===o.state&&(o.state="UPDATE",a()))}return l},l.removeTween=function(t,e,s){var i=u.length;"undefined"==typeof s&&(s=!0);for(var n=0;i>n;n++){var o=u[n];o.target!==t||e&&o.tween!==e||(u.splice(n,1),s&&r(o.tween,0),i--,n--)}return l},l.removePin=function(e,s){"string"==typeof e&&(e=t(e)),"undefined"==typeof s&&(s=!0);for(var i=d.length,n=0;i>n;n++){var a=d[n];a.el.is(e)&&(d.splice(n,1),s&&(a.spacer.remove(),o(a),a.anim&&r(a.anim,0)),i--,n--)}return l},l.setScrollContainerOffset=function(t,e){return h.x=t,h.y=e,l},l.triggerCheckAnim=function(t){return t?a():v=!0,l},s(),l}}(jQuery);