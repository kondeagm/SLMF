List = function() {

	this.settings = {

		a: $SlmfTeam.find("ul.team a"),
		li: $SlmfTeam.find("ul.team li"),
		header: $SlmfTeam.find("header"),
		container: $SlmfTeam.find("#slmf-team-home-container"),
		slider: {
			item: $(".slmf_slider_container"),
			busy: false,
			current: 0,
			tlHome: null,
			tlKai: null,
			tlRegula: $("#labs_slider_regula"),
			tlDesarrollo: $("#labs_slider_desarrollo"),
			tlEnergia: $("#labs_slider_energia"),
			menu:{
				tlMenuTeam:null,
				tlMenuItem1:null,
				tlMenuItem2:null,
				tlMenuItem3:null,
				tlMenuItem4:null,
			}
		},
	};

	var totalOffset = 0;
	this.lastActive = null;
};

List.prototype.init = function() {

	this.initTimeline();
	this.bind();
	
};
List.prototype.initHomeAnimation = function()
{
	console.log("initTimeline");
	this.settings.slider.tlHome.play(0);
	this.settings.slider.menu.tlMenuTeam.play(0);
};
List.prototype.bind = function() {

	var self = this;
	$("body").on("keydown",function(event){self.keydown(event,self);});
	// Hover
	$(".bullets a").on("mouseenter",function(event){self.playTimelimeMenu(event);});
	$(".bullets a").on("mouseleave",function(event){self.reverseTimelimeMenu(event);});
	$(".bullets a").on("click",function(event){self.menuClick(event,self);});

	$(".labs_changer_menu a").on("click",function(event){self.changer(event,self);});
	

	this.settings.a
		.each(function() {

			var el = $(this),
				hover = $(this).parent().find("img.hover"),
				back = $(this).parent().find("img.back"),
				tooltip = $(this).parent().find(".tooltip"),
				icon = $(this).parent().find(".logo"),
				header = $(this).parent().find("header");

			el
				.mousemove(function(e) {

					if(el.hasClass('hover')){return;}
					el.addClass('hover');
					self.animations({
						el: el,
						back: back,
						hover: hover,
						tooltip: tooltip,
						icon: icon,
						header: header,
						action: "mouseenter"
					});
				})
				.mouseleave(function(e) {
					el.removeClass('hover');
				});;

		});
	this.settings.header
		.mouseenter(function(e) {

			self.animations({
				action: "mouseleave"
			});
		});
	this.settings.container
		.mouseleave(function(e) {

			self.animations({
				action: "mouseleave"
			});
		})
	$("#header-main")
		.mouseenter(function(e) {

			self.animations({
				action: "mouseleave"
			});
		});

		
};
List.prototype.initTimeline = function()
{
	slider= this.settings.slider;
	// HOME
	this.makeHomeTimeline(slider);
	//this.makeRegulaTimeline(slider);
	
	/*slider.tlRegula = this.makeStdTimeline($("#labs_slider_regula",slider.item),false);
	slider.tlGraham = this.makeStdTimeline($("#labs_slider_regula",slider.item),true);
	slider.tlTank   = this.makeStdTimeline($("#team_slider_tank",slider.item),false);*/

	slider.menu.tlMenuTeam = this.makeStdMenuTimeline($("#bullet_home"));
	slider.menu.tlMenuItem1 = this.makeStdMenuTimeline($("#bullet_item1"));
	slider.menu.tlMenuItem2 = this.makeStdMenuTimeline($("#bullet_item2"));
	slider.menu.tlMenuItem3 = this.makeStdMenuTimeline($("#bullet_item3"));
	slider.menu.tlMenuItem4 = this.makeStdMenuTimeline($("#bullet_item4"));
};

List.prototype.makeHomeTimeline= function(slider)
{
	homeBg = $("#labs_slider_home .bg_lights",slider.item);
	homeFigure1 = $("#labs_slider_home .bg_figure1",slider.item);
	
	homeLogo    = $("#labs_home_logo svg",slider.item);
	homeSpacer  = $(".header_spacer",slider.item);
	
	homeText    = $(".top_vertical p",slider.item);
	
	slider.tlHome = new TimelineLite({});
	slider.tlHome.fromTo(homeFigure1, 0.45,{ autoAlpha: 0},
		{
			autoAlpha: 1,
			ease: Linear.easeNone,
		});
	slider.tlHome.fromTo(homeBg, 0.80,{ autoAlpha: 0},
		{
			autoAlpha: 1,
			ease: Linear.easeNone,
		},'=-0.2');
	
	slider.tlHome.fromTo(homeLogo, 0.45,{ autoAlpha: 0,x: -50},
		{
			autoAlpha: 1,
			x: 0,
			ease: Cubic.easeInOut,
		},'=-0.60');
	
	slider.tlHome.fromTo(homeSpacer, 0.30,{ autoAlpha: 0,height: 0},
		{
			autoAlpha: 1,
			height: 85,
			ease: Cubic.easeInOut,
		},'=-0.10');

	slider.tlHome.fromTo(homeText, 0.30,{ autoAlpha: 0,y: 45},
		{
			autoAlpha: 1,
			y: 0,
			ease: Cubic.easeOut,
		},'=-0.2');

	
	slider.tlHome.pause(0);
};
List.prototype.makeRegulaTimeline= function(slider)
{
	// Kai
	kaiBg = $("#team_slider_kai .bg_lights",slider.item);
	kaiFigure = $("#team_slider_kai .bg_figure",slider.item);

	kaiTitle1    = $("#team_slider_kai .bg_text",slider.item);
	kaiTitle2    = $("#team_slider_kai_txt_2",slider.item);
	kaiH3    = $("#team_slider_kai h3",slider.item);
	kaiText    = $("#team_slider_kai p",slider.item);
	kaiBtn    = $(".home_content_btn ",slider.item);
	
	slider.tlKai = new TimelineLite({});
	slider.tlKai.fromTo(kaiFigure, 0.45,{ autoAlpha: 0},
		{
			autoAlpha: 1,
			ease: Linear.easeNone,
		});
	slider.tlKai.fromTo(kaiBg, 0.45,{ autoAlpha: 0},
		{
			autoAlpha: 1,
			ease: Linear.easeNone,
		},'=-0.2');
	slider.tlKai.fromTo(kaiTitle1, 0.45,{ autoAlpha: 0,x: -45},
		{
			autoAlpha: 1,
			x: 0,
			ease: Cubic.easeOut,
		},'=-0.3');
	slider.tlKai.fromTo(kaiTitle2, 0.45,{ autoAlpha: 0,x: -45},
		{
			autoAlpha: 1,
			x: 0,
			ease: Cubic.easeOut,
		},'=-0.3');

	slider.tlKai.fromTo(kaiH3, 0.45,{ autoAlpha: 0,y: 45},
		{
			autoAlpha: 1,
			y: 0,
			ease: Cubic.easeOut,
		},'=-0.15');

	slider.tlKai.fromTo(kaiText, 0.45,{ autoAlpha: 0},
		{
			autoAlpha: 1,
			ease: Linear.easeNone,
		}, "-=0.15");

	/*
	slider.tlKai.fromTo(kaiBtn, 0.3, {
				scale: 1.6,
				autoAlpha: 0
			}, {
				
				scale: 1.0,
				autoAlpha: 1,
				ease: Power2.easeIn,
			},'=-0.15');
	slider.tlKai.timeScale(1.3);
	*/
	slider.tlKai.pause(0);
};
List.prototype.makeStdTimeline=function (slider_item,isLeft)
{
	timeline = new TimelineLite({});
	_current = $(".current",slider_item);
	//slideItem_Bg = $(".bg_lights",slider_item);
	slideItem_Figure = $(".bg_figure",_current);
	slideItem_Title1 = $(" .bg_text",slider_item);
	slideItem_menu = $(" .labs_changer_menu",slider_item);
	slideItem_H3        = $("h3",_current);
	slideItem_Text      = $(".description",_current);
	slideItem_Card      = $(".team_ficha_container",_current);
	slideItem_CardItem1 = $("ul li",_current).eq(0);
	slideItem_CardItem2 = $("ul li",_current).eq(1);
	slideItem_CardItem3 = $("ul li",_current).eq(2);
	slideItem_btn     = $(".home_content_btn",_current);
	
	timeline.timeScale(1.5);
	//timeline.set(slideItem_Title1,{opacity:0,visibily: 'hidden'});
	bulletLeft = 100;
	if(slider_item.hasClass("labs_left")) bulletLeft = -100;

	timeline.fromTo(slideItem_Figure, 0.45,{ autoAlpha: 0},
		{ autoAlpha: 1,ease: Linear.easeNone,});
	
	/*timeline.fromTo(slideItem_Bg, 0.45,{ autoAlpha: 0},
		{ autoAlpha: 1,ease: Linear.easeNone,},'=-0.2');*/
	
	

	timeline.fromTo(slideItem_Title1, 1.2,{ autoAlpha: 0.5,y: "-100%"},
		{ autoAlpha: 1,y: 0,ease: Cubic.easeOut,},'=-0.3');
	
	timeline.fromTo(slideItem_menu, 0.45,{ autoAlpha: 0},
		{ autoAlpha: 1,
			ease: Cubic.easeOut,
		},'=-0.65');

	timeline.fromTo(slideItem_H3, 0.45,{ autoAlpha: 0,y: 45},
		{ autoAlpha: 1,y: 0,
			ease: Cubic.easeOut,
		},'-=0.2');
		timeline.fromTo(slideItem_Text, 0.30,{ autoAlpha: 0},
		{
			autoAlpha: 1,
			ease: Linear.easeNone,
		}, "-=0.15");

	timeline.fromTo(slideItem_Card, 0.30,{ autoAlpha: 0,height: 0},
		{
			autoAlpha: 1,
			height: 97,
			ease: Linear.easeNone,
		}, "-=0.15");

	timeline.fromTo(slideItem_CardItem1, 0.30,{ autoAlpha: 0,x: bulletLeft},
		{
			autoAlpha: 1,
			x: 0,
			ease: Cubic.easeOut,
		}, "-=0.15");
	timeline.fromTo(slideItem_CardItem2, 0.30,{ autoAlpha: 0,x: bulletLeft},
		{
			autoAlpha: 1,
			x: 0,
			ease: Cubic.easeOut,
		}, "-=0.15");
	timeline.fromTo(slideItem_CardItem3, 0.30,{ autoAlpha: 0,x: bulletLeft},
		{
			autoAlpha: 1,
			x: 0,
			ease: Cubic.easeOut,
		});

	timeline.fromTo(slideItem_btn, 0.3, {
				scale: 1.6,
				autoAlpha: 0
			}, {
				
				scale: 1.0,
				autoAlpha: 1,
				ease: Power2.easeIn,
			},'=-0.15');
	
	//timeline.pause(0);
	
	//return timeline;
};
List.prototype.makeStdMenuTimeline=function (menu_item)
{
	timeline = new TimelineLite({});

	menu_item_p = $(".p_container p",menu_item);
	menu_item_under = $(".under",menu_item);
	//timeline.set(menu_item_under,{opacity:0,visibily: 'hidden'});
	timeline.fromTo(menu_item_p, 0.25,{ autoAlpha: 0,y: 25},
		{ autoAlpha: 1,y: 0,ease: Cubic.easeOut,});

	timeline.fromTo(menu_item_under, 0.25,{ width: 15,backgroundColor: "#ffffff"},
		{ width: 50,backgroundColor: "#e7d133",ease: Cubic.easeOut,},'=-0.25');

	timeline.pause();
	return timeline;
};
List.prototype.keydown = function(event,env)
{
	switch(event.which)
	{
		case 38:env.prev();
		break;
		case 40:env.next();
		break;
		/* shortcuts */
		case 49:this.settings.slider.current= 0;
			this.gotoSlide(false);
		break;
		case 50:this.settings.slider.current= 1;
			this.gotoSlide(false);
		break;
		case 51:this.settings.slider.current= 2;
			this.gotoSlide(false);
		break;
		case 52:this.settings.slider.current= 3;
			this.gotoSlide(false);
		break;
		case 53:this.settings.slider.current= 4;
			this.gotoSlide(false);
		break;
	}
};
List.prototype.next= function()
{
	if(this.settings.slider.busy){return false;}

	if(this.settings.slider.current==4){return false;}

	this.settings.slider.busy= true;
	this.settings.slider.current++;
	this.gotoSlide(false);
};
List.prototype.prev= function()
{
	
	if(this.settings.slider.busy){return false;}
	if(this.settings.slider.current===0){return false;}

	this.settings.slider.busy= true;
	this.settings.slider.current--;
	this.gotoSlide(false);
};
List.prototype.gotoSlide= function(isFromBtn)
{
	console.log("gotoSlide");
	console.log(this.settings.slider.current);
	slider= this.settings.slider;

	btn= $(".bullet_item.active");
	btn.removeClass("active");
	var menu = this.settings.slider.menu;
	
	switch(btn.attr("id"))
	{
		case 'bullet_home':menu.tlMenuTeam.reverse(1);
		break;
		case 'bullet_item1':menu.tlMenuItem1.reverse(1);
		break;
		case 'bullet_item2':menu.tlMenuItem2.reverse(1);
		break;
		case 'bullet_item3':menu.tlMenuItem3.reverse(1);
		break;
		case 'bullet_item4':menu.tlMenuItem4.reverse(1);
		break;
	}

	switch(this.settings.slider.current)
	{
		case 0:this.SlidermoveTo("0",slider.tlHome,slider.menu.tlMenuTeam,isFromBtn,false);//home
			$("#bullet_home").addClass("active");
		break;
		case 1:this.SlidermoveTo("-100%",slider.tlRegula,slider.menu.tlMenuItem1,isFromBtn,true);//kai 
			$("#bullet_item1").addClass("active");
		break;
		case 2:this.SlidermoveTo("-240%",slider.tlDesarrollo,slider.menu.tlMenuItem2,isFromBtn,true);//charro
			$("#bullet_item2").addClass("active");
		break;
		case 3:this.SlidermoveTo("-380%",slider.tlEnergia,slider.menu.tlMenuItem3,isFromBtn,true);//graham
			$("#bullet_item3").addClass("active");
		break;
		case 4:this.SlidermoveTo("-520%",slider.tlEspeciales,slider.menu.tlMenuItem4,isFromBtn,false);//tank
			$("#bullet_item4").addClass("active");
		break;
	}
};

List.prototype.SlidermoveTo = function(to_,timeline,menuTimeline,isFromBtn,isStdAnimation)
{
	self = this;
	if(!isStdAnimation)
	{
		timeline.pause(0);
	}
	TweenMax.to(this.settings.slider.item, 0.7, {
		top: to_,
		ease: Cubic.easeOut,
		onComplete:function()
		{
			self.settings.slider.busy = false;
			//timeline.play(0);
			if(!isFromBtn)
				menuTimeline.play(0);
		}
	});
	if(isStdAnimation)
	{
		setTimeout(function(){self.makeStdTimeline(timeline);},0.3);
	}
	else
	{
		setTimeout(function(){timeline.play(0);},0.3);
	}
};

List.prototype.playTimelimeMenu= function(event)
{
	btn = $(event.currentTarget);
	btn.addClass("hover");
	if($(btn).hasClass("active")) return false;
	btn.addClass("hover");

	var menu = this.settings.slider.menu;
	switch(btn.attr("id"))
	{
		case 'bullet_home':menu.tlMenuTeam.play(0);
		break;
		case 'bullet_item1':menu.tlMenuItem1.play(0);
		break;
		case 'bullet_item2':menu.tlMenuItem2.play(0);
		break;
		case 'bullet_item3':menu.tlMenuItem3.play(0);
		break;
		case 'bullet_item4':menu.tlMenuItem4.play(0);
		break;
	}
};
List.prototype.reverseTimelimeMenu= function(event)
{
	btn = $(event.currentTarget);
	btn.removeClass("hover");
	if($(btn).hasClass("active")) return false;
	
	var menu = this.settings.slider.menu;
	switch(btn.attr("id"))
	{
		case 'bullet_home':menu.tlMenuTeam.reverse(1);
		break;
		case 'bullet_item1':menu.tlMenuItem1.reverse(1);
		break;
		case 'bullet_item2':menu.tlMenuItem2.reverse(1);
		break;
		case 'bullet_item3':menu.tlMenuItem3.reverse(1);
		break;
		case 'bullet_item4':menu.tlMenuItem4.reverse(1);
		break;
	}
};
List.prototype.menuClick= function(event)
{
	if(this.settings.slider.busy)return false;
	if($(btn).hasClass("active")) return false;
	console.log("click");
	this.settings.slider.busy = true;
	
	btn = $(event.currentTarget);

	
	var menu = this.settings.slider.menu;
	
	switch(btn.attr("id"))
	{
		case 'bullet_home':this.settings.slider.current=0;
		break;
		case 'bullet_item1':this.settings.slider.current=1;
		break;
		case 'bullet_item2':this.settings.slider.current=2;
		break;
		case 'bullet_item3':this.settings.slider.current=3;
		break;
		
		case 'bullet_item4':this.settings.slider.current=4;
		break;
	}
	this.gotoSlide(btn.hasClass("hover"));
};
List.prototype.changer= function(event)
{
	event.preventDefault();
	_btn= $(event.currentTarget);
	if(_btn.hasClass("current")) return false;
	_parent= $(_btn).parent();

	id= _btn.attr('id').replace("menu_labs_","");
	
	$(".labs_changer_menu_item.current",_parent).removeClass("current");
	_btn.addClass("current");
	changer = _parent.parent().parent();
	
	this.changeSection($("#labs_"+id,changer),changer);

};
List.prototype.changeSection= function(section,changer)
{
	console.log("---------");
	console.log("changeSection");
	current = $(".labs_changer_item.current",changer);
	console.log(section);

	TweenMax.fromTo($(".bg_figure",current), 0.2,{ autoAlpha: 1},
		{
			autoAlpha: 0,
			ease: Linear.easeNone,
		});

	TweenMax.fromTo($(".labs_right_container",current), 0.2,{ autoAlpha: 1},
		{
			autoAlpha: 0,
			ease: Linear.easeNone,			
		});


	TweenMax.fromTo($(".bg_figure",section), 0.45,{ autoAlpha: 0},
		{
			autoAlpha: 1,
			ease: Linear.easeNone,
			delay:0.2,
		});

	TweenMax.fromTo($(".labs_right_container",section), 0.2,{ autoAlpha: 0},
		{
			autoAlpha: 1,
			ease: Linear.easeNone,
			delay:0.2,
			onComplete: function()
			{
				current.removeClass("current");
				section.addClass("current");
			}
		});
	
};
List.prototype.animations = function(params) {
	var self = this;


	function hideTooltips(el) {
		if (el) {
			el = el.parent();

			TweenMax.to([$(el).find('.tooltip'), $(el).find('img.back')], 0.25, {
				autoAlpha: 0,
				ease: Linear.easeNone
			});
			self.lastActive = false;
		}
	}
	// console.log(params.action)
	switch (params.action) {
		case "mouseleave":

			hideTooltips(self.lastActive);
			break;
		case "mouseenter":
			var position = $(params.el).attr("data-position");
			hideTooltips(self.lastActive);

			self.lastActive = params.el;

			params.hover.css("z-index", 0);
			params.back.css("z-index", 1);
			TweenMax.to(params.back, 0.25, {
				autoAlpha: 1,
				ease: Linear.easeNone
			});

			$(this.settings.li).each(function(index, el) {
				var distance = $(el).find("a").attr("data-distance");
				TweenMax.to(el, .5, {
					left: position * 18 * distance,
					ease: Quad.easeOut,
					onComplete: function() {
						// Aparece icono de tooltip
						if (self.lastActive && self.lastActive.parent() != $(el)) {

							TweenMax.set(params.icon, {
								autoAlpha: 0
							});
							TweenMax.fromTo(params.icon, .35, {
								autoAlpha: 1,
								x: "300%",
								y: "-300%",
							}, {
								x: "0%",
								y: "0%",
								delay: .1,
								ease: Cubic.easeOut,
							});

							// Aparece nombre de atleta de tooltip
							TweenMax.set(params.header, {
								autoAlpha: 0
							});
							TweenMax.fromTo(params.header, .35, {
								autoAlpha: 1,
								x: "100%",
								y: "-100%",
							}, {
								x: "0%",
								y: "0%",
								ease: Cubic.easeOut,
							});

							// Aparece contenedor de tooltip
							TweenMax.set(params.tooltip, {
								autoAlpha: 1,
								x: "100%",
								y: "-100%",
								ease: Cubic.easeOut,
							});
							TweenMax.to(params.tooltip, .35, {
								x: "0%",
								y: "0%",
								ease: Cubic.easeOut,
							});
						}

					}
				});



			});
			break;
	};
};

SlmfTeam = {

	init: function(images) {

		this.cachedElements();

		list = new List();
		list.init();

		_onLoadImages(images, function() {

			$SlmfTeam.removeLoader({
				onComplete: function() {
					list.initHomeAnimation();
					

				}
			});
		});
	},
	cachedElements: function() {

		$SlmfTeam = $("#slmf-team-home");
	},
};